alias setJava11="export JAVA_HOME=`/usr/libexec/java_home -v 11` && java -version"
alias setJava17="export JAVA_HOME=`/usr/libexec/java_home -v 17` && java -version"
alias setJava21="export JAVA_HOME=`/usr/libexec/java_home -v 21` && java -version"

# experimental
alias gw="./gradlew"
alias tf="terraform"
alias brew_housekeeping="brew update && brew upgrade && brew autoremove && brew cleanup --prune=all"
alias realpath=/opt/homebrew/bin/grealpath
alias gzip=/opt/homebrew/bin/gzip

# HomeLab
alias rpi1="ssh $USER@rpi-01.local"
alias rpi2="ssh $USER@rpi-02.local"
alias rpi3="ssh $USER@rpi-03.local"
alias rpi4="ssh $USER@rpi-04.local"
alias rpi5="ssh $USER@rpi-05.local"
alias rpi6="ssh $USER@rpi-06.local"

# colorls
 if [ -x "$(command -v colorls)" ]; then
    alias ls="colorls"
    alias la="colorls -al"
fi

# kubernetes
alias kubectl=kubecolor
alias k=kubectl
alias kg='kubectl get'
alias kd='kubectl describe'
alias ke='kubectl exec -it'
alias kdp='kubectl delete pod'
alias kshowctx='kubectl config get-contexts'
# select k8s cluster/context
function kc() {
  kubectl config use-context $(kubectl config get-contexts -o name | fzf)
}

# select k8s namespace
function kns() {
  kubectl config set-context --current --namespace=$(kubectl get namespaces --output=jsonpath='{range .items[*]}{.metadata.name}{"\n"}'|fzf)
}

# get k8s resources, default to pods
function krs() {
  kubectl get ${1:-pods} --output=jsonpath='{range .items[*]}{.metadata.name}{"\n"}'
}

# just an alias to use krs
function kpods() {
  krs
}

# use fzf to auto complete resource type for krs
function _krs_completion() {
  COMPREPLY=( $(kubectl api-resources -o name| fzf) )
}

# shorthand for k exec -ti <pod-name> -- ..., using fzf to select the pod
function kexec() {
  pod=$(krs| fzf)
  container=$(kubectl get pods $pod -o jsonpath="{range .spec['containers'][*]}{.name}{'\n'}"|fzf)
  kubectl exec -ti $pod -c $container -- $@
}

# shorthand for k logs -f <pod-name> <container-name>, using fzf to select the pod
function klogs() {
  pod=$(krs| fzf)
  container=$(kubectl get pods $pod -o jsonpath="{range .spec['containers','initContainers'][*]}{.name}{'\n'}"|fzf)
  kubectl logs -f $pod $container
}

# shorthand for k describe <resource-type> <resource-name>, type defaults to pod and using fzf to select the resource
function kdr() {
  kubectl describe ${1:-pod} $(krs ${1:-pod}| fzf)
}

# decrypt secrets
function kds() {
  secret=$(krs secret| fzf)
  kubectl get secret $secret -o go-template='{{range $k,$v := .data}}{{"### "}}{{$k}}{{"\n"}}{{$v|base64decode}}{{"\n\n"}}{{end}}'
}

